[:project
 [{n_name n.5/n_name} revenue]
 [:order-by
  [[revenue {:direction :desc, :null-ordering :nulls-first}]]
  [:project
   [n.5/n_name {revenue xt$sum_out_7}]
   [:group-by
    [n.5/n_name {xt$sum_out_7 (sum xt$sum_in_8)}]
    [:map
     [{xt$sum_in_8 (* l.3/l_extendedprice (- 1 l.3/l_discount))}]
     [:mega-join
      [(= c.1/c_custkey o.2/o_custkey)
       (= l.3/l_orderkey o.2/o_orderkey)
       (= l.3/l_suppkey s.4/s_suppkey)
       (= c.1/c_nationkey s.4/s_nationkey)
       (= s.4/s_nationkey n.5/n_nationkey)
       (= n.5/n_regionkey r.6/r_regionkey)]
      [[:rename c.1 [:scan {:table customer} [c_nationkey c_custkey]]]
       [:rename
        o.2
        [:scan
         {:table orders}
         [o_custkey
          {o_orderdate
           (and
            (<
             o_orderdate
             (+
              #time/date "1994-01-01"
              (single-field-interval "1" "YEAR" 2 6)))
            (>= o_orderdate #time/date "1994-01-01"))}
          o_orderkey]]]
       [:rename
        l.3
        [:scan
         {:table lineitem}
         [l_discount l_suppkey l_orderkey l_extendedprice]]]
       [:rename s.4 [:scan {:table supplier} [s_nationkey s_suppkey]]]
       [:rename
        n.5
        [:scan {:table nation} [n_nationkey n_name n_regionkey]]]
       [:rename
        r.6
        [:scan
         {:table region}
         [{r_name (= r_name "ASIA")} r_regionkey]]]]]]]]]]
